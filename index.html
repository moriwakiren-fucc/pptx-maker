<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>AIスライド生成支援ツール</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
<!-- ハンバーガーメニュー部分 -->
<div class="nav">

  <!-- ハンバーガーメニューの表示・非表示を切り替えるチェックボックス -->
  <input id="drawer_input" class="drawer_hidden" type="checkbox">

  <!-- ハンバーガーアイコン -->
  <label for="drawer_input" class="drawer_open"><span class="icon"></span></label><label for="drawer_input" class="nav_title">AIに貼り付けるプロンプトを</label>

  <!-- メニュー -->
  <nav class="nav_content">
    <pre class="prompt-box" id="prompt"># jsを用いたPowerPoint作成
## 指示
あなたはプロのプレゼンデザイナー兼JavaScriptエンジニアです。
以下の【スライドの内容】に基づくPowerPointを作るためのpptxgenjsのコードを書いてください。
ただし、以下の【プログラムにおける規則】, 【デザインの原則】, 【その他の条件】を必ず全て守り、結果のみを出力してください。

---
<details>
<summary>## 【プログラムにおける規則】</summary>
- pptxgenjs を必ず使うこと
- import を書いてはいけない
- 結果はコードブロックに出力すること
- コード生成後にそのコードの実行(スライドの生成)はせず、そのまま終了すること
- 図形（長方形・線など）は省略記法（rect, line, ellipse 等）を一切使用しないこと
- defineSlideMaster や addSlide 内の objects では、必ず以下の公式使用通りの正式記法で記述すること
  ```
  {
    shape: pres.shapes.RECTANGLE,
    x: 数値または'%',
    y: 数値または'%',
    w: 数値または'%',
    h: 数値,
    fill: { color: '16進数カラー' }
  }
  ```
- shape プロパティを省略したコードは禁止
- pptxgen.shapes.LINE / pres.shapes.RECTANGLE など、公式 enum を必ず明示すること
- 「短縮形」「新しい書き方」「最近のサンプル由来の省略構文」は使用しないこと
- Missing/Invalid shape parameter エラーが発生しないことを最優先にすること
- ブラウザで動く書き方にすること
- html や css を一切書いてはいけない
- require を使ってはいけない
- new PptxGenJS() を使うこと
- pres.writeFile() まで含めること
- console.log や説明文を書いてはいけない
- 図形は slide.addShape(pres.shapes.XXXX, {...}) の形式で書くこと
</details>
---
<details>
<summary>## 【デザインの原則】</summary>

### 原則1：色に「意味」を持たせる
- 全スライドで一貫したカラーパレットを1つ決める
- 「肯定・推奨」→ 緑系、「否定・問題」→ 赤系、「データ・未確定」→ 黄色、
  「強調・結論」→ アクセントカラー のように色と意味を対応させる
- 装飾目的だけの色使いは禁止

### 原則2：毎スライドで異なるレイアウトを使う
以下のパターンを組み合わせ、同じ構造を2スライド以上連続させない
- 左右2カラム（比較・対比）
- カードグリッド（2×2, 2×3）
- ステップフロー（矢印つき横並び）
- 左アクセントバー付き引用ブロック
- 番号バッジ付きリスト

### 原則3：フォントサイズで視線を誘導する
- タイトル：36〜40pt
- セクション見出し：18〜22pt
- 本文：12〜14pt
- 強調数値・キーワード：28〜36pt
- 同じサイズのテキストを3行以上並べない

### 原則4：比較・対立はかならず視覚化する
- 「AではなくB」という構造は、左右に並べて色・アイコンで明示する
- ✗（赤）と ✓（緑）を使い、どちらが採用されたかを一目で分かるようにする
- テキストで「〜が問題」と書くだけでなく、形と色でも伝える

### 原則5：抽象的な結論には必ず根拠を添える
- 「最適と判断した」→ 必ず理由を3点以上箇条書きで添える
- 「問題がある」→ 具体的に何が問題かを明記する
- 1スライドに1文だけ書くのは禁止。最低3つの情報を載せる

### 原則6：全スライドに統一ヘッダーを設ける
- 全スライドの最上部（y:0）に同じ色のヘッダーバーを配置する
- ヘッダーの高さ・色・フォントは全スライドで統一する
- 表紙・参考文献も例外なく同じルールを適用する

### 原則7：データが必要な箇所は黄色矩形で明示する
- 統計・グラフ・地図など実データが入る予定の箇所には
  背景色が yellow の長方形を置き、「何を表すデータか」を内部に記載する

### 原則8：目次スライドは全スライドの構造を反映する
- 目次には全スライドのタイトルを番号付きで列挙する
- 少数行で済ませない。実際のスライド枚数に対応した詳細な目次にする

### 原則9：禁止事項
- 全スライドで同一レイアウトの繰り返し
- タイトル＋大きな矩形＋1〜2文テキストのみの構成
- 意味のない色の使用（装飾だけの彩色）
- フォントサイズの差が6pt未満のテキスト群
</details>
---

## 【その他の条件】
- スライドの枚数は<input type="text" pattern="\d*" inputmode="numeric" size="4" id="min">枚以上<input type="text" pattern="\d*" inputmode="numeric" size="4" id="max">枚以下とする
- 定義,背景,理由などを勝手に省略せず、明示する
- 説明文は十分な分量を許容する
- 根拠のない結論文を書いてはいけない
<span class="ikanoran" id="ikanoran"><b>以下の欄にここに書かれていない「カスタム条件」を記入し、プロンプトに反映させることもできます("- "[半角ハイフン+半角スペース]で箇条書きを表せます)。</b></span>
<textarea rows="5" placeholder="カスタム条件" id="demand" class="promput"></textarea>

---
 
## 【スライドの内容】
<textarea rows="5" placeholder="生成したいスライドの内容（テーマ・構成など）を入力" id="promput" class="promput"></textarea>
</pre>
    <div class="AIbuttons">
    <button onclick="copyButton()" id="copybutton">コピーする</button>
    <button onclick="window.open('https://chatgpt.com/', '_blank', 'noopener,noreferrer')" style="margin-left:2em;">ChatGPTを開く</button>
    <button onclick="window.open('https://claude.ai', '_blank', 'noopener,noreferrer')">Claudeを開く</button>
    <button onclick="window.open('https://gemini.google.com/', '_blank', 'noopener,noreferrer')">Geminiを開く</button>
    <button onclick="window.open('https://copilot.microsoft.com', '_blank', 'noopener,noreferrer')">Copilotを開く</button>
    <button onclick="window.open('https://www.genspark.ai', '_blank', 'noopener,noreferrer')">Gensparkを開く</button>
    </div>
  </nav>

</div>

  <h2>AIスライド生成支援ツール</h2>
  
  <textarea class="codeinput" id="codeInput" placeholder="ここに pptxgenjs のコードを貼り付けてください"></textarea>

  <button id="runBtn">スライド生成（PPTXダウンロード）</button>

  <pre id="errorBox"></pre>

  <!-- pptxgenjs CDN -->
  <script src="https://cdn.jsdelivr.net/npm/pptxgenjs@3.12.0/dist/pptxgen.bundle.js"></script>
  <script src="main.js"></script>
</body>
</html>
